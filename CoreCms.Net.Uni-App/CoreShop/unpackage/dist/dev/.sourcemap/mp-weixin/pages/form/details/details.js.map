{"version":3,"sources":["uni-app:///main.js","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/form/details/details.vue?8a48","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/form/details/details.vue?d91a","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/form/details/details.vue?7abb","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/form/details/details.vue?6238","uni-app:///pages/form/details/details.vue","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/form/details/details.vue?9c01","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/form/details/details.vue?8187"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","mixins","data","formBoxId","form","headType","showPage","slideImg","region","areaId","pickerValue","show","pickerList","province","pickerIndex","provinceKey","cityKey","areaKey","pics","goodsNums","cart","currentKey","currentGoodsId","goodsTotalMoney","originForm","paymentType","onLoad","computed","hasLogin","userInfo","get","set","onShow","methods","goHome","console","uni","url","getFullPath","init","showThreePicker","onConfirm","provinceName","cityName","countyName","that","title","content","showCancel","getFormDetail","id","token","success","_this","type","bindDateChange","item","bindTimeChange","radioChange","checkboxChange","valChange","chooseLocation","items","setTimeout","fail","picChoose","picDel","formSubmit","keys","key","value","postData","pushData","tempArray","formReset","closeModal","specifications","getGoodsInfo","getNumsByKey","goodsAddCart","productId","goodsId","nums","price","isIn","getCartNums","itemKey","cartCount","getGoodsTotalMoney","getSpes","selectSku","getShareUrl","client","page","params","watch","handler","deep","onShareAppMessage","path","onShareTimeline"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,gBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgI;AAChI;AAC2D;AACL;AACsC;;;AAG5F;AACyK;AACzK,gBAAgB,6KAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,8FAAM;AACR,EAAE,uGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,kGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,6MAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,oNAEN;AACP,KAAK;AACL;AACA,aAAa,8MAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,2OAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACzEA;AAAA;AAAA;AAAA;AAAkoB,CAAgB,inBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;AC6RtpB;AACA;AAAA;AAAA;AAAA,eACA;EACAC;EACAC;IAAA;IACA;MACAC;MACAC;QACAC;MACA;MACAC;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IAAA,sDACA,0DAEA,sDACA,mDACA,0DACA,2DACA,2DACA,4DACA,0DACA,qDACA,sDACA,4DACA,wDACA,8EACA,0DACA;EAEA;EACAC;IACA;IACA;MACA;MACA;IACA;IACA;IACA;EACA;EACAC,0CACA;IACAC;MAAA;IAAA;IACAC;MAAA;IAAA;EACA;IACAD;MACAE;QACA;MACA;MACAC;QACA;MACA;IACA;EAAA,EACA;EACAC;IACA;EACA;EACAC;IACAC;MACAC;MACAC;QACAC;MACA;IACA;IACA;IACAC;MACA;QACA;UACA;YACA;YACA;UACA;YACA;cACA;cACA;YACA;cACA;cACA;YACA;UACA;QACA;UACA;YACA;cACA;gBACA;cACA;gBACA;cACA;YACA;YACA;cACA;cACA;gBACA;cACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACAJ;MACA;MACA;MACAA;IACA;IACA;IACAK;MACA;MACA;MACA;IACA;IACAC;MACAN;MACA;MACA;MACA;MACA;MACA;MACA;QACAO;QACAC;QACAC;MACA;MACA;MACA;MACA;QACA;UACAC;UACAA;QACA;UACAT;YACAU;YACAC;YACAC;UACA;QACA;MACA;MACAb;IACA;IACAc;MAAA;MACA;MACA;QACAC;QACAC;MACA;MACA;MACA;QACA;UACA;UACA;UACA;UACA;YACA;UACA;UACA;YACA;cACA;cACAN;YACA;cACA;cACAA;YACA;UACA;QAEA;UACA;UACA;YACAT;cACAU;cACAC;cACAC;cACAI;gBACA;kBACAC;oBAAAC;oBAAAjB;kBAAA;gBACA;cACA;YACA;UACA;YACAF;YACA;cAAAmB;cAAAjB;YAAA;YACA;YACA;YACA;YACA;;YAEA;YACA;YACA;YACA;YACA;;YAEA;cACA;cACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAkB;MACAC;IACA;IACA;IACAC;MACAD;IACA;IACA;IACAE;MACAF;IACA;IACA;IACAG;MACA;MACA;QACA;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACA,WACAC;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACAzB;QACAgB;UACAI;UACAM;UACAC;YACAlB;UACA;QACA;QACAmB;UACA5B;YACAgB;cACA;gBACAhB;cACA;YACA;UACA;QACA;MACA;IACA;IACA6B;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACAT;MACA;MACA;QACAX;UAAAC;UAAAQ;QAAA;QACA;MACA;MAEA;QACA;UACAE;UAKAM;UACAC;YACAlB;UACA;UAEAA;YAAAC;YAAAQ;UAAA;QACA;UACAT;YAAAC;YAAAQ;UAAA;QACA;MACA;MAEAnB;IAEA;IACA;IACA+B;MACAV;MACA;IACA;IACA;IACAW;MAAA;MACA;MACA;MACA;MACA;MACAC;QACA;QACA;QACA;UACAC;UACAC;QACA;QACAC;MACA;MACA;;MAEApC;MAGA;QACA;UACA;UACA;QACA;QACA;QACA;UACA;YACA;cAAAkC;cAAAC;YAAA;YACAE;YACAC;UACA;YACA;YACA;cACA;gBACAjB;gBACA;cACA;YACA;YACA;cACA;gBAAAa;gBAAAC;cAAA;cACAE;cACAC;YACA;UACA;QACA;QACAA;UACAjB;UACAe;QACA;MACA;MACApC;MACAA;MAEA;MACA;QACAjC;QACAgD;QACAC;MACA;MACA;MACA;QACA;QACA;UACA;UACA;YACAN;cAAAC;cAAAQ;YAAA;YACA;YACAS;cACA;cACAlB;gBACAS;gBAAAjB,8FACA;cACA;YACA;UACA;YACAQ;YACAA;cAAAC;cAAAQ;YAAA;YACA;YACAS;cACAnE;gBACAyC;cACA;YACA;UACA;QACA;UACA;QACA;MACA;IACA;IACA;IACAqC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA,aACAC;MACA;MACA;QACA;MACA;QACA;UACA;YACA;UACA;QACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;QACA;UACAV;UACAW;UACAC;UACAC;UACAC;QACA;MACA;QACA;QACA;UACA;YACA;cACAd;cACAW;cACAC;cACAC;cACAC;YACA;YACAC;UACA;QACA;QACA;UACA;YACAf;YACAW;YACAC;YACAC;YACAC;UACA;QACA;MACA;MAEA;MACA;IACA;IACAE;MACA;MACA;MACA;QACA;UACAC;QACA;MACA;MACA;MACA;QACA;UACA;UACA;UACA;YACA;cACAC;YACA;YACA1C;UACA;QACA;UACA;QACA;MACA;QACA;MACA;MACA;IACA;IACA;IACA2C;MACA;MACA;MACA;QACAjE;MACA;MACA;IACA;IACAkE;MACA;QACA;MACA;MACA;IACA;IACA;IACAC;MAAA;MACA;MACA;QACAxC;MACA;QACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;IACA;IACA;IACAyC;MAAA;MACA;QACAC;QACAvD;QACAiB;QACAuC;QACAC;UACA5C;QACA;MACA;MACA;MACA;QACAhD;MACA;MACA;QACA;MACA;IACA;EACA;EACA6F;IACA5F;MACA6F;QACA;MACA;MACAC;IACA;EACA;EACA;EACAC;IACA;MACApD;MACAqD;IACA;EACA;EACAC;IACA;MACAtD;MACAqD;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACz2BA;AAAA;AAAA;AAAA;AAA6tC,CAAgB,wnCAAG,EAAC,C;;;;;;;;;;;ACAjvC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/form/details/details.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/form/details/details.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./details.vue?vue&type=template&id=3cb301ba&scoped=true&\"\nvar renderjs\nimport script from \"./details.vue?vue&type=script&lang=js&\"\nexport * from \"./details.vue?vue&type=script&lang=js&\"\nimport style0 from \"./details.vue?vue&type=style&index=0&id=3cb301ba&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3cb301ba\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/form/details/details.vue\"\nexport default component.exports","export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./details.vue?vue&type=template&id=3cb301ba&scoped=true&\"","var components\ntry {\n  components = {\n    uToast: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-toast/u-toast\" */ \"@/uview-ui/components/u-toast/u-toast.vue\"\n      )\n    },\n    uNoNetwork: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-no-network/u-no-network\" */ \"@/uview-ui/components/u-no-network/u-no-network.vue\"\n      )\n    },\n    uNavbar: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-navbar/u-navbar\" */ \"@/uview-ui/components/u-navbar/u-navbar.vue\"\n      )\n    },\n    uSelect: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-select/u-select\" */ \"@/uview-ui/components/u-select/u-select.vue\"\n      )\n    },\n    uPopup: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-popup/u-popup\" */ \"@/uview-ui/components/u-popup/u-popup.vue\"\n      )\n    },\n    uAvatar: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-avatar/u-avatar\" */ \"@/uview-ui/components/u-avatar/u-avatar.vue\"\n      )\n    },\n    uNumberBox: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-number-box/u-number-box\" */ \"@/uview-ui/components/u-number-box/u-number-box.vue\"\n      )\n    },\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-button/u-button\" */ \"@/uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    coreshopLoginModal: function () {\n      return import(\n        /* webpackChunkName: \"components/coreshop-login-modal/coreshop-login-modal\" */ \"@/components/coreshop-login-modal/coreshop-login-modal.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./details.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./details.vue?vue&type=script&lang=js&\"","<template>\r\n    <view v-show=\"showPage\">\r\n        <u-toast ref=\"uToast\" /><u-no-network></u-no-network>\r\n        <u-navbar :custom-back=\"goHome\" back-icon-name=\"home\" :title=\"form.name\"></u-navbar>\r\n        <form @submit=\"formSubmit\" bindreset=\"formReset\">\r\n                <view v-if=\"form.headType==1\">\r\n                    <view class=\"banner\">\r\n                        <image :src='slideImg[0]' mode='widthFix'></image>\r\n                    </view>\r\n                </view>\r\n                <!-- 轮播图 -->\r\n                <view v-else-if=\"form.headType == 2\">\r\n                    <view>\r\n                        <view class='sw'>\r\n                            <swiper>\r\n                                <swiper-item v-for=\"(item,itemIndex) in slideImg\" :key=\"itemIndex\">\r\n                                    <image :src=\"item\" class=\"slide-image\" mode='widthFix' />\r\n                                </swiper-item>\r\n                            </swiper>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n                <view v-else-if=\"form.headType==3\">\r\n                    <view class='video'>\r\n                        <video :src='form.headTypeVideo' :poster=\"form.headTypeValue\"></video>\r\n                    </view>\r\n                </view>\r\n                <!-- 纯文字 -->\r\n                <view v-if=\"form.description !=''\">\r\n                    <view class='plaintext'>\r\n                        <text>{{form.description}}</text>\r\n                    </view>\r\n                </view>\r\n            <view class=\"u-margin-bottom-20 u-margin-top-20 u-padding-10 coreshop-bg-white\">\r\n                <view v-for=\"(item,index) in form.items\" :key=\"index\">\r\n                    <view class='goods-box-item' v-if=\"item.type=='goods'\">\r\n                        <view class='input-box-item-left u-padding-bottom-20'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必选）</text>：</text>\r\n                        </view>\r\n                        <image class='goods-img' :src='item.good.image' mode='aspectFit'></image>\r\n                        <view class='goods-right'>\r\n                            <view class='goods-name'>{{item.good.name}}</view>\r\n                            <view class='goods-mid'>\r\n                                <text>已售{{item.good.buyCount}}</text>\r\n                            </view>\r\n                            <view class='goods-buttom'>\r\n                                <view class=\"goods-price\">￥{{item.good.price}}</view>\r\n                                <view class='choose-specs' @click=\"specifications($event,item)\" data-type='1' :data-goods=\"item.good.id\" :data-id=\"item.id\" data-statu=\"openspecs\">\r\n                                    选规格\r\n                                </view>\r\n                                <text class='order-num' v-if=\"item.cartCount> 0\">{{item.cartCount || 0}}</text>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 文本框 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='text'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必填）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <input class='ib-item-input' type=\"text\" :name=\"'objName'+item.id\" :data-id=\"item.id\" v-model=\"item.defaultValue\" :placeholder=\"'请输入'+item.name\"></input>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 日期 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='date'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必选）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <view class=\"ib-item-mid\">\r\n                                <picker mode=\"date\" :name=\"'objName'+item.id\" :value=\"item.defaultValue\" @change=\"bindDateChange($event,item)\" :data-id='item.id'>\r\n                                    <view>{{item.defaultValue}}</view>\r\n                                </picker>\r\n                                <image class='icon-img-right' :src=\"$globalConstVars.apiFilesUrl+'/static/images/common/ic-unfold.png'\"></image>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 时间 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='time'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必选）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <view class=\"ib-item-mid\">\r\n                                <picker class=\"weui-btn\" :name=\"'objName'+item.id\" mode=\"time\" :value=\"item.defaultValue\" @change=\"bindTimeChange($event,item)\" :data-id='item.id'>\r\n                                    <view>{{item.defaultValue}}</view>\r\n                                </picker>\r\n                                <image class='icon-img-right' :src=\"$globalConstVars.apiFilesUrl+'/static/images/common/ic-unfold.png'\"></image>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 范围选择 -->\r\n                    <!-- 多选 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='checbox'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必选）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <view class='checkout-list'>\r\n                                <checkbox-group @change=\"checkboxChange($event,item)\" :data-value=\"item.id\" :name=\"'objName'+item.id\">\r\n                                    <label class=\"checkout-item\" v-for=\"(checkboxItem,itemIndex) in item.checkboxValue\" :key=\"itemIndex\">\r\n                                        <view class=\"checkout-item-c\">\r\n                                            <checkbox class=\"\" :value=\"checkboxItem.value\" :checked=\"checkboxItem.checked\" /> {{checkboxItem.value}}\r\n                                        </view>\r\n                                    </label>\r\n                                </checkbox-group>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- radio时处理 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='radio'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必选）</text>:</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <radio-group class=\"uni-list\" @change=\"radioChange($event,item)\" :data-value=\"item.id\" :name=\"'objName'+item.id\">\r\n                                <label class=\"u-margin-right-40\" v-for=\"(radioItem, itemIndex) in  item.radioValue\" :key=\"itemIndex\">\r\n                                    <view class=\"coreshop-display-inline-block\">\r\n                                        <radio class=\"a-radio\" :id=\"radioItem\" :value=\"radioItem\" checked=true v-if=\"radioItem==item.defaultValue\"></radio>\r\n                                        <radio class=\"a-radio\" :id=\"radioItem\" :value=\"radioItem\" v-if=\"radioItem!=item.defaultValue\"></radio>\r\n                                    </view>\r\n                                    <view class=\"coreshop-display-inline-block\">\r\n                                        <label class=\"label-2-text\" :for=\"radioItem\">\r\n                                            <text>{{radioItem}}</text>\r\n                                        </label>\r\n                                    </view>\r\n                                </label>\r\n                            </radio-group>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 省市区选择 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='area'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必选）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <view class=\"ib-item-mid\">\r\n                                <input class=\"ib-item-input\" :value=\"pickerValue\" @focus=\"showThreePicker\" :name=\"'objName'+item.id\" style=\"width: 100%;\" />\r\n                                <u-select v-model=\"show\" mode=\"mutil-column-auto\" :list=\"pickerList\" :default-value=\"pickerIndex\" @confirm=\"onConfirm\"></u-select>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 金额 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='money'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必填）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <view class=\"ib-item-mid\">\r\n                                <input class='ib-item-input' type=\"digit\" :name=\"'objName'+item.id\" v-model=\"item.defaultValue\" \r\n                                        :placeholder=\"'请输入'+item.name\"></input>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 密码 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='password'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必填）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <view class=\"ib-item-mid\">\r\n                                <input class='ib-item-input' type='password' :name=\"'objName'+item.id\" v-model=\"item.defaultValue\" \r\n                                        :placeholder=\"'请输入'+item.name\"></input>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 图片 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='image'\">\r\n                        <view class='u-font-28'>上传{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必传）</text>（限制3张）</view>\r\n                        <view class='u-margin-top-15'>\r\n                            <view class='upload-img-list'>\r\n                                <view class='upload-img-bd'>\r\n                                    <view class='upload-img' v-for=\"(picItem, i) in item.pics\" :key=\"i\">\r\n                                        <image @click='picDel(item,index,i)' :data-index=\"i\" class='del-img' :src=\"$globalConstVars.apiFilesUrl+'/static/images/common/del.png'\"></image>\r\n                                        <image class='upload-camera' :src=\"picItem\" mode='aspectFit'></image>\r\n                                        <input type='text' hidden='hidden' :name=\"'objName'+item.id\" v-model=\"item.pics\" />\r\n                                    </view>\r\n                                </view>\r\n                                <view class='upload-img-hd'>\r\n                                    <image class='upload-camera' :src=\"$globalConstVars.apiFilesUrl+'/static/images/common/camera.png'\" @click=\"picChoose($event,item,index)\"\r\n                                            :data-id=\"item.id\"></image>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 文本域 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='textarea'\">\r\n                        <view class='u-font-28'>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必填）</text>：</view>\r\n                        <view class='u-margin-top-15'>\r\n                            <textarea :name=\"'objName'+item.id\" class='ib-item-textarea' :placeholder=\"'请输入'+item.name\" ></textarea>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 定位 -->\r\n                    <view class='form-input-box-item' v-if=\"item.type=='coordinate'\">\r\n                        <view class='input-box-item-left'>\r\n                            <text>{{item.name}}<text v-if=\"item.required\" class=\"coreshop-bg-red u-font-22\">（必选）</text>：</text>\r\n                        </view>\r\n                        <view class='input-box-item-right'>\r\n                            <view class=\"ib-item-mid coreshop-justify-start\">\r\n                                <image class='icon-img' :src=\"$globalConstVars.apiFilesUrl+'/static/images/common/ic-location.png'\"></image>\r\n                                <input class='ib-item-input u-margin-right-40' :name=\"'objName'+item.id\" :value=\"item.defaultValue\"\r\n                                        disabled='disabled' placeholder=\"点击获取位置信息\" @click=\"chooseLocation($event,item,index)\" :data-id='item.id' />\r\n                            </view>\r\n                        </view> \r\n                    </view>\r\n                </view>\r\n            </view>\r\n            <view class='goods-bottom' v-if=\"form.type==1\">\r\n                <text class='coreshop-float-right u-font-28 coreshop-text-black'>\r\n                    合计\r\n                    <text class='coreshop-text-red u-font-30'>￥{{goodsTotalMoney}}</text>\r\n                </text>\r\n            </view>\r\n            <view class=\"coreshop-tabbar-height\"></view>\r\n            <!-- 底部按钮 -->\r\n            <view class='coreshop-bg-white coreshop-footer-fixed coreshop-foot-padding-bottom'>\r\n                <view class=\"u-padding-10\">\r\n                    <button :style='{backgroundColor:form.buttonColor}' class=\"bottom-btn\" data-statu=\"open\" form-type=\"submit\" :disabled='submitStatus' :loading='submitStatus'>\r\n                    {{buttonName}}\r\n                    </button>\r\n                </view>\r\n            </view>\r\n        </form>\r\n\r\n        <!--弹出框-->\r\n        <u-popup class=\"coreshop-bottom-popup-box\" v-model=\"bottomModal\" mode=\"bottom\"  border-radius=\"14\" closeable=\"true\" height=\"60%\">\r\n            <!-- 多规格商品弹出 -->\r\n            <block v-if=\"showSpecs\">\r\n                <view class=\"coreshop-bg-white\">\r\n                    <!--标题-->\r\n                    <view class=\"coreshop-text-black u-text-center u-margin-top-30 u-margin-bottom-30 u-font-lg coreshop-title-bar\">\r\n                        <text>选择商品</text>\r\n                    </view>\r\n                    <!--内容区域-->\r\n                    <view class=\"coreshop-modal-content\">\r\n                        <!--选择规格-->\r\n                        <view class=\"coreshop-common-view-box select\">\r\n                            <!--商品信息-->\r\n                            <view class=\"coreshop-list menu-avatar\">\r\n                                <view class=\"coreshop-list-item\">\r\n                                    <view class=\"coreshop-avatar radius lg\" :style=\"[{backgroundImage:'url('+ goodsInfoImage +')'}] \" />\r\n                                    <view class=\"content\">\r\n                                        <view class=\"coreshop-text-price-view\">\r\n                                            <text class=\"coreshop-text-price coreshop-text-red u-margin-right-20\">{{goodsInfoName}}</text>\r\n                                            <text class=\"u-font-sm coreshop-text-gray\">￥{{goodsInfoPrint}}</text>\r\n                                        </view>\r\n                                    </view>\r\n                                </view>\r\n                            </view>\r\n                            <!--规格数据-->\r\n                            <view class=\"coreshop-select-btn-list-box\">\r\n                                <view class=\"select-item\" v-for=\"(value,key) in goodsSpesDesc\" :key=\"key\">\r\n                                    <text class='coreshop-text-black u-margin-10  coreshop-solid-bottom u-padding-bottom-20'>{{key}}</text>\r\n                                    <view class='select-btn'>\r\n                                        <button class=\"sku-btn u-margin-10\"  :class='i.isDefault ? \"selected\" : \"not-selected\"' v-for=\"(i,itemIndex) in value\" :key=\"itemIndex\"  :data-key=\"i.productId\" :data-id=\"i.name\"  @click=\"selectSku\">\r\n                                            <u-avatar :src=\"i.image\" size=\"50\" class=\"u-margin-right-10 u-margin-top-10\" style=\"margin-left: -20rpx;\"></u-avatar>\r\n                                            {{ i.name }}\r\n                                        </button>\r\n                                    </view>\r\n                                </view>\r\n                                <!-- 库存 -->\r\n                                <view class=\"select-item\">\r\n                                    <view class=\"coreshop-text-black\">数量</view>\r\n                                    <view class=\"select-btn\">\r\n                                        <u-number-box v-model=\"goodsNums\" :min=\"0\"  :max=\"goodsInfoNumber\" @change=\"valChange\"></u-number-box>\r\n                                    </view>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                        <!--公共按钮-->\r\n                        <view class=\"u-padding-30 u-text-center\">\r\n                            <u-button type=\"error\" size=\"medium\" @click='goodsAddCart' v-if=\"status\">确定</u-button>\r\n                            <u-button type=\"default\" size=\"medium\" v-else>已售罄</u-button>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n            </block>\r\n        </u-popup>\r\n\r\n\r\n        <!-- 登录提示 -->\r\n        <coreshop-login-modal></coreshop-login-modal>\r\n    </view>\r\n</template>\r\n<script>\r\n    import { goods, articles, commonUse, tools } from '@/common/mixins/mixinsHelper.js'\r\n    import { mapMutations, mapActions, mapState } from 'vuex';\r\n    export default {\r\n        mixins: [goods, articles, commonUse, tools],\r\n        data() {\r\n            return {\r\n                formBoxId: '',\r\n                form: {\r\n                    headType: 1,\r\n                },\r\n                showPage: true,\r\n                slideImg: [], //幻灯片广告数据\r\n                region: ['湖南省', '怀化市', '鹤城区'],\r\n                areaId: 431202,\r\n                pickerValue: '',\r\n                show: false,\r\n                pickerList: this.$db.get(\"areaList\"),\r\n                province: this.$db.get(\"areaList\"),\r\n                pickerIndex: [0, 0, 0], // picker索引值\r\n                provinceKey: -1,//省份id\r\n                cityKey: -1,//市id\r\n                areaKey: -1,//区域id\r\n                pics: [], //图片\r\n                goodsNums: 0,\r\n                cart: [],\r\n                currentKey: 0, //当前下单的商品的Key\r\n                currentGoodsId: 0, //当前选中的商品ID\r\n                goodsTotalMoney: '0.00', //商品总额\r\n                originForm: [], //原始表单\r\n                paymentType: '', //支付类型\r\n                paymentType: '', //表单付款码||表单订单\r\n                /** 商品信息*/\r\n                goodsSpesDesc: '',\r\n                productId: '',\r\n                status: '',\r\n                goodsInfoName: '',\r\n                goodsInfoImage: '',\r\n                goodsInfoPrint: '',\r\n                goodsInfoNumber: '',\r\n                selectGoodsId: '',\r\n                selectId: '',\r\n                showSpecs: false,\r\n                submitStatus: false, //按钮状态\r\n                shareUrl: '/pages/share/jump/jump',\r\n                bottomModal: false,\r\n                buttonName: '',\r\n            }\r\n        },\r\n        onLoad(options) {\r\n            var id = options.id\r\n            if (!id) {\r\n                this.$u.toast('路径错误')\r\n                return false\r\n            }\r\n            this.formBoxId = id\r\n            this.$db.set('formBoxId', id)\r\n        },\r\n        computed: {\r\n            ...mapState({\r\n                hasLogin: state => state.hasLogin,\r\n                userInfo: state => state.userInfo,\r\n            }),\r\n            hasLogin: {\r\n                get() {\r\n                    return this.$store.state.hasLogin;\r\n                },\r\n                set(val) {\r\n                    this.$store.commit('hasLogin', val);\r\n                }\r\n            }\r\n        },\r\n        onShow() {\r\n            this.getFormDetail()\r\n        },\r\n        methods: {\r\n            goHome() {\r\n                console.log(\"回主页\");\r\n                uni.switchTab({\r\n                    url: '/pages/index/default/default'\r\n                });\r\n            },\r\n            //倒查城市信息\r\n            getFullPath(id, data) {\r\n                for (var i = 0; i < data.length; i++) {\r\n                    if (id == data[i].value) {\r\n                        if (!data[i].children) {\r\n                            this.areaKey = i;\r\n                            return true;\r\n                        } else if (data[i].hasOwnProperty(\"children\")) {\r\n                            if (data[i].children[0] && !data[i].children[0].children) {\r\n                                this.cityKey = i;\r\n                                return true;\r\n                            } else {\r\n                                this.provinceKey = i;\r\n                                return true;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (data[i].hasOwnProperty(\"children\")) {\r\n                            if (data[i].children[0] !== undefined) {\r\n                                if (data[i].children[0].hasOwnProperty(\"children\")) {\r\n                                    this.provinceKey = i;\r\n                                } else {\r\n                                    this.cityKey = i;\r\n                                }\r\n                            }\r\n                            if (typeof data[i].children != 'undefined') {\r\n                                var res = this.getFullPath(id, data[i].children);\r\n                                if (res) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            init() {\r\n                console.log(this.areaId);\r\n                this.getFullPath(this.areaId, this.province);\r\n                this.pickerIndex = [this.provinceKey, this.cityKey, this.areaKey];\r\n                console.log(this.pickerIndex);\r\n            },\r\n            // 省市区联动初始化\r\n            showThreePicker() {\r\n                this.pickerValue = this.region[0] + ' ' + this.region[1] + ' ' + this.region[2];\r\n                this.init();\r\n                this.show = true;\r\n            },\r\n            onConfirm(e) {\r\n                console.log(e);\r\n                var that = this\r\n                let provinceName = e[0].label;\r\n                let cityName = e[1].label;\r\n                let countyName = e[2].label;\r\n                this.pickerValue = e[0].label + \" \" + e[1].label + \" \" + e[2].label\r\n                let data = {\r\n                    provinceName: provinceName,\r\n                    cityName: cityName,\r\n                    countyName: countyName\r\n                }\r\n                let regionName = [provinceName, cityName, countyName];\r\n                this.region = regionName;\r\n                this.$u.api.getAreaId(data).then(res => {\r\n                    if (res.status) {\r\n                        that.areaId = res.data;\r\n                        that.init();\r\n                    } else {\r\n                        uni.showModal({\r\n                            title: '提示',\r\n                            content: '地区选择出现问题，请重新选择地区',\r\n                            showCancel: false\r\n                        });\r\n                    }\r\n                });\r\n                console.log(this.areaId);\r\n            },\r\n            getFormDetail() {\r\n                var _this = this;\r\n                var data = {\r\n                    id: this.formBoxId,\r\n                    token: this.$db.get('userToken')\r\n                }\r\n                var that = this\r\n                this.$u.api.getFormDetial(data).then(res => {\r\n                    if (res.status) {\r\n                        this.form = res.data\r\n                        this.originForm = res.data\r\n                        this.buttonName = res.data.buttonName\r\n                        if (res.data.images) {\r\n                            this.slideImg = res.data.images.split(',');\r\n                        }\r\n                        if (res.data.type == '1' || res.data.type == '2') {\r\n                            if (res.data.type == '1') {\r\n                                //订单\r\n                                that.paymentType = this.$globalConstVars.paymentType.formPay\r\n                            } else if (res.data.type == '2') {\r\n                                //付款码\r\n                                that.paymentType = this.$globalConstVars.paymentType.formOrder\r\n                            }\r\n                        }\r\n\r\n                    } else {\r\n                        this.showPage = false;\r\n                        if (res.data.isExpires) {\r\n                            uni.showModal({\r\n                                title: '提示',\r\n                                content: '表单已过期，请扫描新的二维码',\r\n                                showCancel: false,\r\n                                success: function (res) {\r\n                                    if (res.confirm) {\r\n                                        _this.$u.route({ type: 'switchTab', url: '/pages/index/default/default' })\r\n                                    }\r\n                                }\r\n                            })\r\n                        } else if (res.data.needLogin) {\r\n                            console.log(\"要登录权限了\");\r\n                            this.$u.route({ type: 'switchTab', url: '/pages/index/default/default' })\r\n                            //if (this.$db.get('userToken')) {\r\n                            //    this.hasLogin = true\r\n                            //    this.$u.api.userInfo().then(res => {\r\n                            //        if (res.status) {\r\n\r\n                            //        }\r\n                            //    })\r\n                            //} else {\r\n                            //    this.hasLogin = false\r\n                            //}\r\n\r\n                            if (!this.hasLogin) {\r\n                                this.$store.commit('showLoginTip', true);\r\n                                return false;\r\n                            }\r\n                        }\r\n                    }\r\n                })\r\n            },\r\n            // 选择日期\r\n            bindDateChange(e, item) {\r\n                item.defaultValue = e.target.value\r\n            },\r\n            // 选择时间\r\n            bindTimeChange(e, item) {\r\n                item.defaultValue = e.target.value\r\n            },\r\n            // 单选\r\n            radioChange(e, item) {\r\n                item.defaultValue = e.detail.value\r\n            },\r\n            // 多选\r\n            checkboxChange(e, item) {\r\n                var values = e.detail.value\r\n                for (var i = 0; i < item.checkboxValue.length; ++i) {\r\n                    const checkboxItem = item.checkboxValue[i]\r\n                    if (values.includes(checkboxItem.value)) {\r\n                        this.$set(checkboxItem, 'checked', true)\r\n                    } else {\r\n                        this.$set(checkboxItem, 'checked', false)\r\n                    }\r\n                }\r\n            },\r\n            /* 输入框事件 */\r\n            valChange(e) {\r\n                this.num = e.value;\r\n            },\r\n            //选择位置\r\n            chooseLocation(e, item, index) {\r\n                var pages = getCurrentPages()\r\n                var items = pages[0].$vm.form.items;\r\n                var that = this;\r\n                uni.chooseLocation({\r\n                    success(e) {\r\n                        item.defaultValue = e.latitude + ',' + e.longitude\r\n                        items[index] = item;\r\n                        setTimeout(() => {\r\n                            that.form.items = items;\r\n                        }, 500)\r\n                    },\r\n                    fail(e) {\r\n                        uni.getSetting({\r\n                            success(res) {\r\n                                if (!res.authSetting['scope.userLocation']) {\r\n                                    uni.openSetting()\r\n                                }\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            },\r\n            picChoose(e, item, index) {\r\n                var that = this\r\n                //var pages = getCurrentPages()\r\n                //if (pages.length > 1) {\r\n                //    var items = pages[1].$vm.form.items;\r\n                //} else {\r\n                //    var items = pages[0].$vm.form.items;\r\n                //}\r\n                var items = this.form.items;\r\n                if (!item.pics) {\r\n                    item.pics = []\r\n                }\r\n                if (item.pics.length >= 3) {\r\n                    that.$refs.uToast.show({ title: \"最多允许上传3张图片\", type: 'error' })\r\n                    return false;\r\n                }\r\n\r\n                this.$upload.uploadImage(1, res => {\r\n                    if (res.status) {\r\n                        item.pics.push(res.data.src);\r\n                        // #ifdef H5\r\n                        that.$set(that.form.items, index, item)\r\n                        // #endif\r\n                        // #ifndef H5\r\n                        items[index] = item;\r\n                        setTimeout(() => {\r\n                            that.form.items = items;\r\n                        }, 500)\r\n                        // #endif\r\n                        that.$refs.uToast.show({ title: res.msg, type: 'success' })\r\n                    } else {\r\n                        that.$refs.uToast.show({ title: res.msg, type: 'error' })\r\n                    }\r\n                })\r\n\r\n                console.log(item.pics);\r\n\r\n            },\r\n            //删除图片\r\n            picDel(item, index, i) {\r\n                item.pics.splice(i, 1)\r\n                this.$set(this.form.items, index, item)\r\n            },\r\n            //表单提交\r\n            formSubmit(e) {\r\n                var that = this\r\n                var data = e.detail.value\r\n                var keys = Object.keys(data);\r\n                var postData = [];\r\n                keys.forEach(function (value, index) {\r\n                    var name = value;\r\n                    var id = name.replace('objName', '');\r\n                    let obj = {\r\n                        key: Number(id),\r\n                        value: data[name].toString()\r\n                    };\r\n                    postData.push(obj);\r\n                })\r\n                //订单时需要合并购物车信息\r\n\r\n                console.log(this.cart);\r\n\r\n\r\n                if (this.form.type == 1) {\r\n                    if (this.cart.length < 1) {\r\n                        this.$u.toast('请先选择商品')\r\n                        return true\r\n                    }\r\n                    var tempArray = []\r\n                    this.cart.map((mapItem) => {\r\n                        if (tempArray.length == 0) {\r\n                            let pushData = { key: mapItem.key, value: [] }\r\n                            pushData.value.push(mapItem);\r\n                            tempArray.push(pushData)\r\n                        } else {\r\n                            //判断是否存在同名key的数据，进行累加\r\n                            let res = tempArray.some((item) => {\r\n                                if (item.key == mapItem.key) {\r\n                                    item.value.push(mapItem)\r\n                                    return true\r\n                                }\r\n                            })\r\n                            if (!res) {\r\n                                let pushData = { key: mapItem.key, value: [] }\r\n                                pushData.value.push(mapItem);\r\n                                tempArray.push(pushData)\r\n                            }\r\n                        }\r\n                    })\r\n                    tempArray.forEach(function (item, index) {\r\n                        item.value = JSON.stringify(item.value);\r\n                        postData.push(item);\r\n                    })\r\n                }\r\n                console.log(data);\r\n                console.log(postData);\r\n\r\n                let userToken = this.$db.get('userToken')\r\n                let obj = {\r\n                    data: postData,\r\n                    id: this.form.id,\r\n                    token: userToken\r\n                }\r\n                this.submitStatus = true;\r\n                this.$u.api.addSubmitForm(obj).then(res => {\r\n                    this.submitStatus = false;\r\n                    if (res.status) {\r\n                        //表单类型判断是否需要支付，支付金额多少\r\n                        if (that.form.type == '1' || that.form.type == '2') {\r\n                            that.$refs.uToast.show({ title: res.msg, type: 'success' });\r\n                            //跳转首页\r\n                            setTimeout(function () {\r\n                                //出来支付按钮\r\n                                that.$u.route({\r\n                                    type: 'redirectTo', url: '/pages/payment/pay/pay?formId=' + res.data.formSubmitId + '&type=' + that.paymentType +\r\n                                        '&recharge=' + res.data.money\r\n                                });\r\n                            }, 1000)\r\n                        } else {\r\n                            that.formReset()\r\n                            that.$refs.uToast.show({ title: res.msg, type: 'success' })\r\n                            //跳转首页\r\n                            setTimeout(function () {\r\n                                wx.switchTab({\r\n                                    url: '/pages/index/default/default'\r\n                                })\r\n                            }, 1500)\r\n                        }\r\n                    } else {\r\n                        this.$u.toast(res.msg);\r\n                    }\r\n                });\r\n            },\r\n            //表单清空\r\n            formReset(e) {\r\n                this.$db.set('formBoxId', '')\r\n                this.cart = [] //初始化，刷新当前页面\r\n                this.form = this.originForm\r\n            },\r\n            closeModal() {\r\n                this.bottomModal = false;\r\n                this.showSpecs = false\r\n            },\r\n            //选择规格弹出\r\n            specifications(e, item) {\r\n                this.bottomModal = true;\r\n                this.showSpecs = true\r\n                this.selectId = e.target.dataset.id\r\n                this.selectGoodsId = e.target.dataset.goods\r\n                this.currentKey = e.target.dataset.id //当前选中的key\r\n                this.currentGoodsId = e.target.dataset.goods //当前选中的商品ID\r\n                this.getGoodsInfo(item)\r\n            },\r\n            //获取商品详情\r\n            getGoodsInfo(item) {\r\n                let goods = item.good\r\n                this.goodsSpesDesc = this.$u.deepClone(goods.product.defaultSpecificationDescription);\r\n                this.productId = goods.product.id\r\n                this.goodsInfoName = goods.product.name\r\n                this.goodsInfoImage = goods.product.images\r\n                this.goodsInfoPrint = goods.product.price\r\n                this.goodsInfoNumber = goods.product.stock\r\n                this.goodsNums = this.getNumsByKey(this.currentKey, goods.product.id)\r\n                this.status = goods.product.stock < 1 ? false : true\r\n            },\r\n            /*获取key的数量 */\r\n            getNumsByKey(key, productId) {\r\n                var that = this\r\n                if (that.cart.length < 1) {\r\n                    return 0\r\n                } else {\r\n                    for (var i = 0; i < that.cart.length; i++) {\r\n                        if (that.cart[i].key == key && that.cart[i].productId == productId) {\r\n                            return that.cart[i].nums\r\n                        }\r\n                    }\r\n                    return 0\r\n                }\r\n            },\r\n            //加入购物车\r\n            goodsAddCart: function () {\r\n                var productId = this.productId\r\n                var currentKey = this.currentKey\r\n                if (this.cart.length < 1) {\r\n                    this.cart.push({\r\n                        key: currentKey,\r\n                        productId: productId,\r\n                        goodsId: this.selectGoodsId,\r\n                        nums: this.goodsNums,\r\n                        price: this.goodsInfoPrint\r\n                    })\r\n                } else {\r\n                    var isIn = false\r\n                    for (var i = 0; i < this.cart.length; i++) {\r\n                        if (this.cart[i].key == currentKey && this.cart[i].productId == productId) {\r\n                            this.cart[i] = {\r\n                                key: currentKey,\r\n                                productId: productId,\r\n                                goodsId: this.selectGoodsId,\r\n                                nums: this.goodsNums,\r\n                                price: this.goodsInfoPrint\r\n                            }\r\n                            isIn = true\r\n                        }\r\n                    }\r\n                    if (!isIn) {\r\n                        this.cart.push({\r\n                            key: currentKey,\r\n                            productId: productId,\r\n                            goodsId: this.selectGoodsId,\r\n                            nums: this.goodsNums,\r\n                            price: this.goodsInfoPrint\r\n                        })\r\n                    }\r\n                }\r\n\r\n                this.closeModal();\r\n                this.getCartNums()\r\n            },\r\n            getCartNums() {\r\n                var items = this.form.items\r\n                var itemKey = ''\r\n                for (var i = 0, len = items.length; i < len; ++i) {\r\n                    if (items[i].id == this.currentKey) {\r\n                        itemKey = i\r\n                    }\r\n                }\r\n                var that = this\r\n                if (this.form.items[itemKey].good.id == this.currentGoodsId) {\r\n                    if (this.form.items[itemKey].cartCount > 0) {\r\n                        var cartCount = 0\r\n                        var currentKey = this.currentKey\r\n                        this.cart.forEach(function (item, index, input) {\r\n                            if (item.key == currentKey) {\r\n                                cartCount += item.nums\r\n                            }\r\n                            that.form.items[itemKey].cartCount = cartCount\r\n                        })\r\n                    } else {\r\n                        this.form.items[itemKey].cartCount = this.goodsNums\r\n                    }\r\n                } else {\r\n                    this.form.items[itemKey].cartCount = this.goodsNums\r\n                }\r\n                this.getGoodsTotalMoney()\r\n            },\r\n            //获取商品总额\r\n            getGoodsTotalMoney() {\r\n                var that = this\r\n                var goodsTotalMoney = 0\r\n                this.cart.forEach(function (item, index, input) {\r\n                    goodsTotalMoney += item.price * item.nums\r\n                })\r\n                this.goodsTotalMoney = this.$common.formatMoney(goodsTotalMoney, 2, '')\r\n            },\r\n            getSpes: function (product) {\r\n                if (!product.defaultSpecificationDescription) {\r\n                    return []\r\n                }\r\n                return product.defaultSpecificationDescription\r\n            },\r\n            //获取规格信息\r\n            selectSku(e) {\r\n                var id = e.target.dataset.key\r\n                this.$u.api.getProductInfo({\r\n                    id\r\n                }).then(res => {\r\n                    if (res.status) {\r\n                        this.goodsSpesDesc = this.$u.deepClone(res.data.defaultSpecificationDescription);\r\n                        this.productId = res.data.id\r\n                        this.goodsInfoName = res.data.name\r\n                        this.goodsInfoImage = res.data.images\r\n                        this.goodsInfoPrint = res.data.price\r\n                        this.goodsInfoNumber = res.data.stock\r\n                        this.goodsNums = this.getNumsByKey(this.currentKey, res.data.id)\r\n                        this.status = res.data.stock < 1 ? false : true\r\n                    }\r\n                })\r\n            },\r\n            //获取分享URL\r\n            getShareUrl() {\r\n                let data = {\r\n                    client: 2,\r\n                    url: \"/pages/share/jump/jump\",\r\n                    type: 1,\r\n                    page: 8,\r\n                    params: {\r\n                        id: this.formBoxId\r\n                    }\r\n                };\r\n                let userToken = this.$db.get('userToken');\r\n                if (userToken && userToken != '') {\r\n                    data['token'] = userToken;\r\n                }\r\n                this.$u.api.share(data).then(res => {\r\n                    this.shareUrl = res.data\r\n                });\r\n            }\r\n        },\r\n        watch: {\r\n            formBoxId: {\r\n                handler() {\r\n                    this.getShareUrl();\r\n                },\r\n                deep: true\r\n            }\r\n        },\r\n        //分享\r\n        onShareAppMessage(res) {\r\n            return {\r\n                title: this.form.name,\r\n                path: this.shareUrl\r\n            }\r\n        },\r\n        onShareTimeline(res) {\r\n            return {\r\n                title: this.form.name,\r\n                path: this.shareUrl\r\n            }\r\n        },\r\n    }\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n    @import 'details.scss';\r\n</style>\r\n","import mod from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./details.vue?vue&type=style&index=0&id=3cb301ba&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./details.vue?vue&type=style&index=0&id=3cb301ba&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1723964537886\n      var cssReload = require(\"E:/Share/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}