{"version":3,"sources":["uni-app:///main.js","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/member/afterSales/submit/submit.vue?6e0e","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/member/afterSales/submit/submit.vue?7f08","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/member/afterSales/submit/submit.vue?cbd2","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/member/afterSales/submit/submit.vue?ca98","uni-app:///pages/member/afterSales/submit/submit.vue","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/member/afterSales/submit/submit.vue?ce48","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/member/afterSales/submit/submit.vue?655f"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","typeList","value","name","checked","disabled","typeListByAli","orderId","items","itemIds","aftersaleType","refund","maxRefund","refundShow","images","reason","imageMax","refundInputNoedit","mode","submitStatus","checkedItems","isFlag","costFreight","computed","isImage","methods","radioChange","item","getOrderInfo","id","returnNums","returnStatus","res","console","checkboxChange","nums","onFocus","refundFocus","updateNum","getReturnData","submit","type","_that","title","callback","upImage","back","delImage","newImages","clickImg","uni","urls","onLoad"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;AACsC;;;AAG3F;AAC4K;AAC5K,gBAAgB,6KAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,6MAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AChDA;AAAA;AAAA;AAAA;AAAgpB,CAAgB,gnBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCwIpqB;EACAC;IACA;MACAC,WACA;QAAAC;QAAAC;QAAAC;QAAAC;MAAA,GACA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,EACA;MACAC,gBACA;QAAAJ;QAAAC;QAAAC;QAAAC;MAAA,GACA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,EACA;MACAE;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MACAC;IACA;EACA;;EACAC;IACAC;MACA;MACA;QACA;MACA;QACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;MACA;QACA;UACAC;UACA;QACA;UACAA;QACA;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MAAA;MACA;QACAC;MACA;MACA;QACA;UACA;UACA;YACA;YACA;YACA;cACA5B;YACA;;YAEA;YACA;YACA;YACA;YACA;cACA;gBACA6B;cACA;cACA;gBACAC;cACA;cACAC;cACA;cACAA;cACAA;cACAA;cACA;gBACAA;cACA;gBACAA;cACA;YACA;YACA;YAEAC;YAEA;YACA;YACA;YACA;YACA;UACA;YACA;UACA;QACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MACA;QACA;QACA;UACA;YACA;cACA;cACA;cACAC;cACAN;cACA;gBAAAA;gBAAAM;cAAA;cACAF;YACA;UACA;QACA;MACA;IAEA;IAEA;IACAG;MACAT;MACA;QACA;MACA;MACA;MACA;IACA;IACA;IACAU;MACA;IACA;IAEA;IACAC;MACA;MACAH;MACA;QACA;QACA;QACA;QACA;MACA;;MACA;QACA;MACA;MACA;MACA;MACA;IACA;IAEA;IACAI;MACA;MACA;MACA;QACA;QACA;UACA;YACA;cAEAJ;cACA;gBACAA;gBACA;kBAAAN;kBAAAM;gBAAA;cACA;gBACA;gBACA;cACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAK;MACA;MACA;;MAEA;MACA;MACA;QACA;QACA;QACA;MACA;QACA;UACA;UACA;UACA;QACA;MACA;MACA;QACA;QACA;QACA;MACA;MACAP;MACA;QACA;QACA;QACA;MACA;MACA;MACA;QACA1B;QACAkC;QACAjC;QACAM;QACAH;QACAI;MACA;MACA2B;QACAA;QACA;UACAA;YACAC;YAAAF;YAAAG;cACAF;YACA;UACA;QACA;UACAA;QACA;MACA;IACA;IAEA;IACAG;MAAA;MACA;MACA;QACA;UACA;YACA;YACA;cAAAF;cAAAF;cAAAK;YAAA;UACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;UACAC;QACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACAC;QACAC;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC/ZA;AAAA;AAAA;AAAA;AAAuvC,CAAgB,unCAAG,EAAC,C;;;;;;;;;;;ACA3wC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/member/afterSales/submit/submit.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/member/afterSales/submit/submit.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./submit.vue?vue&type=template&id=7117d49c&scoped=true&\"\nvar renderjs\nimport script from \"./submit.vue?vue&type=script&lang=js&\"\nexport * from \"./submit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./submit.vue?vue&type=style&index=0&id=7117d49c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7117d49c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/member/afterSales/submit/submit.vue\"\nexport default component.exports","export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./submit.vue?vue&type=template&id=7117d49c&scoped=true&\"","var components\ntry {\n  components = {\n    uToast: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-toast/u-toast\" */ \"@/uview-ui/components/u-toast/u-toast.vue\"\n      )\n    },\n    uNoNetwork: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-no-network/u-no-network\" */ \"@/uview-ui/components/u-no-network/u-no-network.vue\"\n      )\n    },\n    uNavbar: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-navbar/u-navbar\" */ \"@/uview-ui/components/u-navbar/u-navbar.vue\"\n      )\n    },\n    uAvatar: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-avatar/u-avatar\" */ \"@/uview-ui/components/u-avatar/u-avatar.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./submit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./submit.vue?vue&type=script&lang=js&\"","<template>\r\n    <view>\r\n        <u-toast ref=\"uToast\" /><u-no-network></u-no-network>\r\n        <u-navbar title=\"提交售后\"></u-navbar>\r\n        <view class=\"content\">\r\n            <view class=\"coreshop-solid-bottom u-font-lg u-padding-30\">\r\n                <uni-text class=\"coreshop-text-black\">\r\n                    <span>请选择退货商品和数量</span>\r\n                </uni-text>\r\n            </view>\r\n\r\n            <form @submit=\"submit\">\r\n                <view class=\"coreshop-content-top\">\r\n                    <view class=\"img-list\">\r\n                        <checkbox-group class=\"cart-checkbox\" v-for=\"(item, key) in items\" :key=\"key\" @change=\"checkboxChange\">\r\n                            <view class=\"cart-checkbox-item\">\r\n                                <label class=\"uni-list-cell uni-list-cell-pd\">\r\n                                    <view class=\"cart-checkbox-c\">\r\n                                        <checkbox :value='item.id' :checked=\"item.checked\" color=\"#FF7159\" v-if=\"item.disabled\" :disabled=\"item.disabled\" class=\"checkboxNo\" />\r\n                                        <checkbox :value='item.id' :checked=\"item.checked\" color=\"#FF7159\" v-else />\r\n                                    </view>\r\n                                    <view class=\"img-list-item\">\r\n                                        <u-avatar :src=\"item.imageUrl\" mode=\"square\" size=\"150\" class=\"img-list-item-l\"></u-avatar>\r\n                                        <view class=\"img-list-item-r\">\r\n                                            <view class=\"list-goods-name\">\r\n                                                {{item.name}}\r\n                                            </view>\r\n                                            <view class=\"goods-item-c u-margin-top-10 u-margin-bottom-10\" v-if=\"item.addon\">\r\n                                                <view class=\"goods-buy\">\r\n                                                    <!-- 商品规格 -->\r\n                                                    <view class=\"goods-salesvolume u-margin-right-10 \">\r\n                                                        {{item.addon}}\r\n                                                    </view>\r\n                                                </view>\r\n                                            </view>\r\n                                            <view class=\"goods-item-c\">\r\n                                                <view class=\"goods-buy\">\r\n                                                    <!-- 商品规格 -->\r\n                                                    <view class=\"goods-salesvolume u-margin-right-10\">\r\n                                                        购买数：{{item.nums}}\r\n                                                    </view>\r\n                                                    <view class=\"goods-salesvolume u-margin-right-10\">\r\n                                                        发货数量：{{item.sendNums}}\r\n                                                    </view>\r\n                                                    <view class=\"goods-salesvolume u-margin-right-10\" v-show=\"item.reshipNums!=0\">\r\n                                                        已退数量：{{item.reshipNums}}\r\n                                                    </view>\r\n                                                    <view class=\"goods-salesvolume u-margin-top-10 u-margin-bottom-10\" v-if=\"!item.disabled\">\r\n                                                        <label>您要退货数量：</label>\r\n                                                        <input type=\"number\" v-model=\"item.returnNums\" @focus=\"onFocus(item,key)\" @blur=\"updateNum(item,key)\" class=\"inputStyle\" ref=\"input\" @click.stop />\r\n                                                    </view>\r\n                                                </view>\r\n                                            </view>\r\n                                        </view>\r\n                                    </view>\r\n                                </label>\r\n                            </view>\r\n                        </checkbox-group>\r\n                    </view>\r\n                    <view class='coreshop-cell-group u-margin-top-20 u-margin-bottom-20'>\r\n                        <view class='coreshop-cell-item'>\r\n                            <view class='coreshop-cell-item-hd'>\r\n                                <view class='coreshop-cell-hd-title'>是否发货</view>\r\n                            </view>\r\n                            <view class='coreshop-cell-item-ft'>\r\n                                <view class=\"uni-form-item uni-column invoice-type\">\r\n                                    <radio-group class=\"uni-list\" @change=\"radioChange\">\r\n                                        <label class=\"uni-list-cell uni-list-cell-pd\" v-for=\"(item, index) in typeList\" :key=\"index\">\r\n                                            <view class=\"invoice-type-icon\">\r\n                                                <radio class=\"a-radio radioNo\" v-if=\"item.disabled\" :id=\"item.name\" :value=\"item.value\" :checked=\"item.checked\"\r\n                                                       :disabled=\"item.disabled\"></radio>\r\n                                                <radio class=\"a-radio \" v-else :id=\"item.name\" :value=\"item.value\" :checked=\"item.checked\" :disabled=\"item.disabled\"></radio>\r\n                                            </view>\r\n                                            <view class=\"invoice-type-c\">\r\n                                                <label :for=\"item.name\">\r\n                                                    <text>{{item.name}}</text>\r\n                                                </label>\r\n                                            </view>\r\n                                        </label>\r\n                                    </radio-group>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                        <view class='coreshop-cell-item refund-price'>\r\n                            <view class='coreshop-cell-item-hd'>\r\n                                <view class='coreshop-cell-hd-title'>退款金额</view>\r\n                            </view>\r\n                            <view class='coreshop-cell-item-ft'>\r\n                                <input type=\"digit\" class='coreshop-cell-bd-input red-price' v-model=\"refund\" @focus=\"refundFocus\" ref=\"refund\"></input>\r\n                            </view>\r\n\r\n                        </view>\r\n                        <view class=\" u-font-24 refund-tip\">\r\n                            可修改，最多￥{{maxRefund}}，含发货邮费￥{{costFreight}}\r\n                        </view>\r\n                    </view>\r\n                    <view class='coreshop-cell-group u-margin-top-20 u-margin-bottom-20'>\r\n                        <view class='coreshop-cell-item right-img'>\r\n                            <view class='coreshop-cell-item-hd'>\r\n                                <view class='coreshop-cell-hd-title'>上传凭证</view>\r\n                            </view>\r\n                        </view>\r\n                        <view class=\"\">\r\n                            <view class=\"evaluate-c-b\">\r\n                                <view class=\"goods-img-item\" v-for=\"(item, key) in images\" :key=\"key\">\r\n                                    <image class=\"del\" src=\"/static/images/common/del.png\" mode=\"\" @click=\"delImage(item)\"></image>\r\n                                    <image class=\"\" :src=\"item\" mode=\"\" @click=\"clickImg(item)\"></image>\r\n                                </view>\r\n                                <view class=\"upload-img\" v-show=\"isImage\" @click=\"upImage\">\r\n                                    <image class=\"icon\" src=\"/static/images/common/camera.png\" mode=\"\"></image>\r\n                                    <view class=\"\">上传照片</view>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <view class='coreshop-cell-group u-margin-top-20 u-margin-bottom-20'>\r\n                        <view class='coreshop-cell-item right-img'>\r\n                            <view class='coreshop-cell-item-hd'>\r\n                                <view class='coreshop-cell-hd-title'>问题描述</view>\r\n                            </view>\r\n                        </view>\r\n                        <view class=\"cell-textarea\">\r\n                            <input v-model=\"reason\" placeholder=\"请您在此描述问题(最多200字)\" maxlength=\"200\" />\r\n                        </view>\r\n                    </view>\r\n                    <view class=\"coreshop-bottomBox\">\r\n                        <button class=\"coreshop-btn coreshop-btn-b coreshop-btn-square\" formType=\"submit\" :disabled='submitStatus' :loading='submitStatus'>提交</button>\r\n                    </view>\r\n                </view>\r\n            </form>\r\n        </view>\r\n    </view>\r\n\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                typeList: [\r\n                    { value: '1', name: '未发货', checked: true, disabled: false },\r\n                    { value: '2', name: '已发货', checked: false, disabled: false },\r\n                ],\r\n                typeListByAli: [\r\n                    { value: '1', name: '仅退款', checked: true, disabled: false },\r\n                    { value: '2', name: '退货退款', checked: false, disabled: false },\r\n                ],\r\n                orderId: '',\r\n                items: [],   //退货明细\r\n                itemIds: [],  //选择的退货\r\n                aftersaleType: 1,     //售后类型1退款，2退款退货\r\n                refund: 0,   //退款金额，等于已支付的金额减去已退款的金额\r\n                maxRefund: 0,//最大可退款金额\r\n                refundShow: 0,\r\n                images: [],      //图片\r\n                reason: '',      //原因\r\n                imageMax: 5,    //用于前台判断上传图片按钮是否显示\r\n                refundInputNoedit: true,\r\n                mode: 'aspectFill',\r\n                submitStatus: false,\r\n                checkedItems: [],//当前选中的商品\r\n                isFlag: true,\r\n                costFreight: 0//运费\r\n            }\r\n        },\r\n        computed: {\r\n            isImage() {\r\n                let num = this.imageMax - this.images.length;\r\n                if (num > 0) {\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            },\r\n        },\r\n        methods: {\r\n            // 单选框点击切换\r\n            radioChange: function (evt) {\r\n                this.typeList.forEach(item => {\r\n                    if (item.value === evt.target.value) {\r\n                        item.checked = true;\r\n                        this.aftersaleType = parseInt(evt.target.value);\r\n                    } else {\r\n                        item.checked = false;\r\n                    }\r\n                });\r\n                if (this.typeList[0].checked) {\r\n                    this.refundInputNoedit = true;\r\n                } else {\r\n                    this.refundInputNoedit = false;\r\n                }\r\n            },\r\n            //订单商品信息\r\n            getOrderInfo() {\r\n                let data = {\r\n                    id: this.orderId\r\n                }\r\n                this.$u.api.orderDetail(data).then(res => {\r\n                    if (res.status) {\r\n                        //如果不是未支付的，已取消的，已完成的状态，就都可以售后\r\n                        if (res.data.globalStatus != 1 && res.data.globalStatus != 6 && res.data.globalStatus != 7) {\r\n                            //判断是已付款未发货，如果是，就禁用退货\r\n                            let typeList = this.typeList;\r\n                            if (res.data.globalStatus == 2) {\r\n                                typeList[1].disabled = true;\r\n                            }\r\n\r\n                            //设置已选中的商品\r\n                            let nums = 0;\r\n                            let returnNums = {}\r\n                            let returnStatus\r\n                            for (var i = 0; i < res.data.items.length; i++) {\r\n                                if (res.data.items[i].nums >= res.data.items[i].reshipNums) {\r\n                                    returnNums = res.data.items[i].nums - res.data.items[i].reshipNums;\r\n                                }\r\n                                if (returnNums > 0) {\r\n                                    returnStatus = true\r\n                                }\r\n                                res.data.items[i].id = res.data.items[i].id.toString();\r\n                                //this.itemIds = this.itemIds.concat({ id: res.data.items[i].id, nums: returnNums });\r\n                                res.data.items[i].returnNums = returnNums\r\n                                res.data.items[i].returnStatus = returnStatus\r\n                                res.data.items[i].checked = false;\r\n                                if (res.data.items[i].returnNums > 0) {\r\n                                    res.data.items[i].disabled = false;\r\n                                } else {\r\n                                    res.data.items[i].disabled = true;\r\n                                }\r\n                            }\r\n                            this.items = res.data.items;\r\n\r\n                            console.log(this.items);\r\n\r\n                            this.refund = this.$common.formatMoney((res.data.orderAmount - res.data.refunded), 2, '');\r\n                            this.maxRefund = this.$common.formatMoney((res.data.orderAmount - res.data.refunded), 2, '');\r\n                            this.costFreight = res.data.costFreight;//运费\r\n                            this.refundShow = res.data.payedAmount - res.data.refunded;\r\n                            this.typeList = typeList;\r\n                        } else {\r\n                            this.$common.errorToBack('订单不可以进行售后');\r\n                        }\r\n                    } else {\r\n                        this.$common.errorToBack('没有找到此订单');\r\n                    }\r\n                });\r\n            },\r\n\r\n            //退货商品选择\r\n            checkboxChange(e) {\r\n                let nums = 0;\r\n                let id = 0;\r\n                this.itemIds = [];\r\n                for (var i = 0; i < e.detail.value.length; i++) {\r\n                    let k = e.detail.value[i];\r\n                    for (var j = 0; j < this.items.length; j++) {\r\n                        if (this.items[j].id == k) {\r\n                            if (this.items[j].nums > this.items[j].reshipNums) {\r\n                                // nums = this.items[j].sendnums - this.items[j].reshipNums;\r\n                                //nums = this.$refs.input[i].value\r\n                                nums = this.items[j].returnNums;\r\n                                id = parseInt(k);\r\n                                this.itemIds = this.itemIds.concat({ id: id, nums: nums });\r\n                                console.log(this.itemIds)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            },\r\n\r\n            // 点击输入框的事件\r\n            onFocus(item, key) {\r\n                item.returnNums = '';\r\n                if (this.checkedItems.indexOf(item.id) == -1) {\r\n                    this.checkedItems.push(item.id)\r\n                }\r\n                this.items[key].checked = true;\r\n                this.getReturnData();\r\n            },\r\n            //处理退款金额光标事件\r\n            refundFocus(e) {\r\n                this.refund = '';\r\n            },\r\n\r\n            //数量改变事件\r\n            updateNum(updateNum, key) {\r\n                let nums = 0;\r\n                nums = this.items[key].nums - this.items[key].reshipNums;\r\n                if (nums < updateNum.returnNums) {\r\n                    this.isFlag = false;\r\n                    this.items[key].returnNums = nums;\r\n                    this.$u.toast(\"您填写的数量不对！\")\r\n                    //return false;\r\n                }\r\n                if (updateNum.returnNums == '') {\r\n                    this.items[key].returnNums = nums;\r\n                }\r\n                this.isFlag = true;\r\n                this.items[key].returnNums = updateNum.returnNums;\r\n                this.getReturnData();\r\n            },\r\n\r\n            //计算要退货的商品数量\r\n            getReturnData() {\r\n                let nums = 0;\r\n                this.itemIds = [];\r\n                for (var i = 0; i < this.checkedItems.length; i++) {\r\n                    let k = this.checkedItems[i];\r\n                    for (var j = 0; j < this.items.length; j++) {\r\n                        if (this.items[j].id == k) {\r\n                            if (this.items[j].nums >= this.items[j].reshipNums) {\r\n\r\n                                nums = this.items[j].nums - this.items[j].reshipNums;\r\n                                if (nums >= this.items[j].returnNums) {\r\n                                    nums = this.items[j].returnNums\r\n                                    this.itemIds = this.itemIds.concat({ id: k, nums: nums });\r\n                                } else {\r\n                                    this.$u.toast(\"您填写的数量不对！\")\r\n                                    return;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n\r\n            //提交\r\n            submit(e) {\r\n                let _that = this;\r\n                this.submitStatus = true;\r\n\r\n                //判断退款金额\r\n                let reg = /^[0-9]+(.[0-9]{1,2})?$/;\r\n                if (!reg.test(this.refund)) {\r\n                    this.$u.toast('请输入正确金额');\r\n                    this.submitStatus = false;\r\n                    return false;\r\n                } else {\r\n                    if (this.refund > this.refundShow) {\r\n                        this.$u.toast('退款金额过大');\r\n                        this.submitStatus = false;\r\n                        return false;\r\n                    }\r\n                }\r\n                if (!this.isFlag) {\r\n                    this.$u.toast('您填写的数量不对！');\r\n                    this.submitStatus = false;\r\n                    return false;\r\n                }\r\n                console.log(this.itemIds)\r\n                if (this.itemIds.length <= 0) {\r\n                    this.$u.toast('请选择要售后的商品');\r\n                    this.submitStatus = false;\r\n                    return false;\r\n                }\r\n                //组装数据，提交数据\r\n                let data = {\r\n                    orderId: _that.orderId,\r\n                    type: _that.aftersaleType,\r\n                    items: _that.itemIds,\r\n                    images: _that.images,\r\n                    refund: _that.refund,\r\n                    reason: _that.reason\r\n                };\r\n                _that.$u.api.addAfterSales(data).then(res => {\r\n                    _that.submitStatus = false;\r\n                    if (res.status) {\r\n                        _that.$refs.uToast.show({\r\n                            title: '提交成功', type: 'success', callback: function () {\r\n                                _that.$u.route(\"/pages/member/order/detail/detail?orderId=\" + _that.orderId)\r\n                            }\r\n                        })\r\n                    } else {\r\n                        _that.$u.toast(res.msg);\r\n                    }\r\n                });\r\n            },\r\n\r\n            //上传图片\r\n            upImage() {\r\n                let num = this.imageMax - this.images.length;\r\n                if (num > 0) {\r\n                    this.$upload.uploadImage(num, res => {\r\n                        if (res.status) {\r\n                            this.images.push(res.data.src);\r\n                            this.$refs.uToast.show({ title: res.msg, type: 'success', back: false });\r\n                        } else {\r\n                            this.$u.toast(res.msg);\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n            //删除图片\r\n            delImage(e) {\r\n                let newImages = [];\r\n                for (var i = 0; i < this.images.length; i++) {\r\n                    if (this.images[i].image_id != e.image_id) {\r\n                        newImages.push(this.images[i]);\r\n                    }\r\n                }\r\n                this.images = newImages;\r\n            },\r\n            // 图片点击放大\r\n            clickImg(img) {\r\n                // 预览图片\r\n                uni.previewImage({\r\n                    urls: img.split()\r\n                });\r\n            }\r\n        },\r\n        onLoad(e) {\r\n            this.orderId = e.orderId;\r\n            this.getOrderInfo();\r\n            this.getReturnData()\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    @import \"submit.scss\";\r\n</style>\r\n","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./submit.vue?vue&type=style&index=0&id=7117d49c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./submit.vue?vue&type=style&index=0&id=7117d49c&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1723964536025\n      var cssReload = require(\"E:/Share/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}