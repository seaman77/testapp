{"version":3,"sources":["uni-app:///main.js","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/index/cart/cart.vue?23ca","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/index/cart/cart.vue?ddae","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/index/cart/cart.vue?f1f3","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/index/cart/cart.vue?7bca","uni-app:///pages/index/cart/cart.vue","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/index/cart/cart.vue?a373","webpack:///E:/Share/CoreShop/CoreCms.Net.Uni-App/CoreShop/pages/index/cart/cart.vue?725d"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","mixins","data","background","backgroundColor","actionStyle","color","searchKey","totalprice","selectText","shoppingCard","cartData","cartIds","goSettlement","selectAll","onShow","onLoad","computed","shopName","GoodsStocksWarn","methods","arrayToStr","getCartData","ids","display","_this","showHandle","stockNo","maxStock","stockTension","isLoad","n","countTotoal","total","_that","numberChange","id","nums","removeGoods","console","uni","title","content","success","type","back","checkout","newData","itemChange","value","itemChangeAll","goSearch"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,aAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACwD;AACL;AACsC;;;AAGzF;AACyK;AACzK,gBAAgB,6KAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,6MAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,6MAEN;AACP,KAAK;AACL;AACA,aAAa,mNAEN;AACP,KAAK;AACL;AACA,aAAa,+NAEN;AACP,KAAK;AACL;AACA,aAAa,2OAEN;AACP,KAAK;AACL;AACA,aAAa,uMAEN;AACP,KAAK;AACL;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACzFA;AAAA;AAAA;AAAA;AAA+nB,CAAgB,8mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;AC4EnpB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eACA;EACAC;EACAC;IACA;MACAC;QACAC;MACA;MACAC;QACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACA;EACAC;IACA;IACA;MACA;IACA;EACA;;EACAC;IACA;IACA;EACA;EACAC;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACA;IACAC;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;QACAC;QACAC;MACA;MACA;QACA;UACAC;UACAA;UACA;QACA;MACA;IACA;;IAEA;IACAC;MAAA;MACA;MACA;MACA;QACA;QACA;UACAxB;QACA;QACA;QACA;QACA;QACA;UACAyB;UACAC;QACA;QACA1B;QACAA;;QAEA;QACA;QACA;UACA2B;QACA;QACA3B;;QAEA;QACAA;QACAA;QACA;UACAA;QACA;QACA;UACAA;QACA;;QAEA;QACAA;QACA;UACA;UACA;YACA;YACAA;UACA;QACA;QACA;QACAA;QACA;QACA;UACAW;QACA;QACA;QACAX;QACA;QACA;UACAA;UACA;YACA;cACAuB;YACA;UACA;QACA;MACA;MACAvB;MACAA;MACAA;MACA;MACA;QACA4B;MACA;MACA;MACA;QACAC;MACA;MAEAN;MACAA;MACAA;MAEA;QACAA;MACA;QACAA;MACA;MACAA;IACA;IAEA;IACAO;MACA;MACA;MACA;QACA;UACAC;QACA;MACA;MACAC;IACA;IACAC;MACA;MACA;MACA;MACA;QACAC;QACAC;MACA;MACAZ;QACA;UACAA;QACA;UACAA;QACA;MACA;MACA;MACA;IACA;IACAa;MACAC;MACA;MACA;MACAC;QACAC;QACAC;QACAC;UACA;YACA;YACA;cACAP;YACA;YACAX;cACA;gBACA;gBACA;gBACA;kBACAA;gBACA;gBACAA;gBACA;gBACAA;gBACAA;kBAAAgB;kBAAAG;kBAAAC;gBAAA;cACA;YACA;UAEA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;QACA;UACAC;UACAtB;QACA;MACA;MACA;QACAsB;MACA;MACA;QACAtB;QACA;MACA;QACA;MAAA;IAGA;IACA;IACAuB;MACA;MACA;MACA;MACA;MACArC;MACA;QACA;UACAc;QACA;MACA;QACA;QACA;UACAA;QACA;MACA;MACAA;MACA;MACA;QACA;QACA;UAAAwB;QAAA;QACA;MACA;QACA;MACA;IAEA;IACAC;MACA;MACA;MACA;MACA;MACA;QACA;QACA;UACA3B;QACA;MACA;MACA;QACAE;MACA;QACAA;MACA;MAEA;IACA;IACA0B;MACA;QACA;MACA;QACA;UACAV;UACAG;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACjXA;AAAA;AAAA;AAAA;AAA0tC,CAAgB,qnCAAG,EAAC,C;;;;;;;;;;;ACA9uC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/index/cart/cart.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/index/cart/cart.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./cart.vue?vue&type=template&id=07f5d349&scoped=true&\"\nvar renderjs\nimport script from \"./cart.vue?vue&type=script&lang=js&\"\nexport * from \"./cart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cart.vue?vue&type=style&index=0&id=07f5d349&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"07f5d349\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/cart/cart.vue\"\nexport default component.exports","export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=template&id=07f5d349&scoped=true&\"","var components\ntry {\n  components = {\n    uToast: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-toast/u-toast\" */ \"@/uview-ui/components/u-toast/u-toast.vue\"\n      )\n    },\n    uNoNetwork: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-no-network/u-no-network\" */ \"@/uview-ui/components/u-no-network/u-no-network.vue\"\n      )\n    },\n    uNavbar: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-navbar/u-navbar\" */ \"@/uview-ui/components/u-navbar/u-navbar.vue\"\n      )\n    },\n    uSearch: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-search/u-search\" */ \"@/uview-ui/components/u-search/u-search.vue\"\n      )\n    },\n    uEmpty: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-empty/u-empty\" */ \"@/uview-ui/components/u-empty/u-empty.vue\"\n      )\n    },\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-button/u-button\" */ \"@/uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uCheckbox: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-checkbox/u-checkbox\" */ \"@/uview-ui/components/u-checkbox/u-checkbox.vue\"\n      )\n    },\n    uNumberBox: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-number-box/u-number-box\" */ \"@/uview-ui/components/u-number-box/u-number-box.vue\"\n      )\n    },\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-icon/u-icon\" */ \"@/uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n    coreshopLoginModal: function () {\n      return import(\n        /* webpackChunkName: \"components/coreshop-login-modal/coreshop-login-modal\" */ \"@/components/coreshop-login-modal/coreshop-login-modal.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = !_vm.shoppingCard.list || _vm.shoppingCard.list.length < 1\n  var g1 = _vm.shoppingCard.list && _vm.shoppingCard.list.length >= 1\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=script&lang=js&\"","<template>\r\n    <view class=\"wrap\">\r\n        <u-toast ref=\"uToast\" /><u-no-network></u-no-network>\r\n        <u-navbar :is-back=\"false\" :background=\"background\">\r\n            <view class=\"slot-wrap\">\r\n                <u-search :show-action=\"true\" shape=\"round\" v-model=\"searchKey\" action-text=\"搜索\" placeholder=\"请输入搜索内容\" @custom=\"goSearch\" @search=\"goSearch\" :action-style=\"actionStyle\"></u-search>\r\n            </view>\r\n        </u-navbar>\r\n        <!-- 购物车为空 -->\r\n        <view v-if=\"!shoppingCard.list || shoppingCard.list.length < 1\">\r\n            <view class=\"coreshop-emptybox\">\r\n                <u-empty :src=\"$globalConstVars.apiFilesUrl+'/static/images/empty/cart.png'\" icon-size=\"300\" text=\"您的购物车空空如也\" mode=\"list\"></u-empty>\r\n                <navigator class=\"coreshop-btn\" url=\"/pages/category/index/index\"  open-type=\"switchTab\">随便逛逛</navigator>\r\n            </view>\r\n        </view>\r\n        <!-- 购物车主结构  -->\r\n        <view v-else class=\"cart-shoppingcard\" v-for=\"(item, index) in shoppingCard.list\" :key=\"index\">\r\n            <view class=\"cart-space-between cart-flex-vcenter\" @click=\"goGoodsDetail(item.products.goodsId)\">\r\n                <view class=\"cart-shopp-name\">\r\n                    <text class=\"cart-h5 cart-bold\">{{item.products.name}}</text>\r\n                </view>\r\n                <view class=\"cart-shopp-go cart-nowrap cart-flex-end\">\r\n                    <u-button class=\"cart-text\" :plain=\"true\" size=\"mini\" @click=\"goGoodsDetail(item.products.goodsId)\">浏览</u-button>\r\n                </view>\r\n            </view>\r\n            <view style=\"height:25rpx;\"></view>\r\n            <view class=\"cart-shoppingcard-goods\">\r\n                <view class=\"cart-shoppingcard-goods-checkbtn\">\r\n                    <u-checkbox @change=\"itemChange\" v-model=\"item.isSelect\" active-color=\"red\" :name=\"index\"></u-checkbox>\r\n                </view>\r\n                <image class=\"cart-shoppingcard-goods-image\" :src=\"item.products.images && item.products.images!='null' ?  item.products.images+'?x-oss-process=image/resize,m_lfit,h_320,w_240' : '/static/images/common/empty-banner.png'\" mode=\"widthFix\"></image>\r\n                <view class=\"cart-shoppingcard-goods-body\">\r\n                    <!--<view class=\"cart-shoppingcard-goods-title\">{{item.products.name}}</view>-->\r\n                    <view class=\"cart-shoppingcard-goods-title\" v-if=\"item.products.spesDesc\">{{ item.products.spesDesc }}</view>\r\n                    <view class=\"cart-shoppingcard-goods-title\" v-if=\"item.products.promotionList\">\r\n                        <text class=\"cart-badge cart-bg-gray\" v-for=\"(v, k) in item.products.promotionList\" :key=\"k\" :class=\"v.type !== 2 ? 'bg-gray' : ''\"> {{ v.name }}</text>\r\n                    </view>\r\n\r\n                    <view class=\"cart-space-between\" style=\"margin-top:20rpx;\">\r\n                        <text class=\"cart-shoppingcard-goods-price\">￥{{item.products.price}}</text>\r\n                        <view class=\"cart-shoppingcard-goods-number\">\r\n                            <u-number-box :disabled=\"false\" :index=\"index\" v-model=\"item.nums\" @change=\"numberChange\" :step=\"1\" :min=\"1\" :max=\"item.products.stock\"></u-number-box>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <view class=\"cart-space-between\">\r\n                        <text class=\"cart-shoppingcard-remove cart-icons icon-msg\" v-if=\"item.stockNo\">库存不足</text>\r\n                        <text class=\"cart-shoppingcard-remove cart-icons icon-msg\" v-else-if=\"item.stockTension\">库存紧张</text>\r\n                        <text class=\"cart-shoppingcard-remove cart-icons\" v-else=\"\"></text>\r\n                        <u-icon class=\"cart-shoppingcard-remove cart-icons icon-remove\" name=\"trash\" size=\"28\" @click=\"removeGoods\" :index=\"index\" label=\"删除\"></u-icon>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n\r\n\r\n        </view>\r\n\r\n        <view class=\"nobox\"></view>\r\n\r\n        <view class=\"cart-nowrap cart-flex-vcenter cart-border-t\" style=\"background-color: #FFFFFF; width: 100%; position: fixed; left: 0; bottom: 0; z-index: 99;\" v-if=\"shoppingCard.list && shoppingCard.list.length >= 1\">\r\n            <view class=\"cart-shoppingcard-checkbtn cart-nowrap cart-flex-vcenter\">\r\n                <u-checkbox @change=\"itemChangeAll\" v-model=\"selectAll\" active-color=\"red\">{{selectText}}</u-checkbox>\r\n            </view>\r\n            <view class=\"cart-shoppingcard-count cart-nowrap cart-flex-vcenter\">\r\n                <text class=\"cart-text\">合计 :</text>\r\n                <text class=\"u-font-26 coreshop-text-red\">￥{{totalprice}}</text>\r\n            </view>\r\n            <view class=\"cart-shoppingcard-checkout cart-coreshop-bg-red\" @tap=\"checkout\">立即结算</view>\r\n        </view>\r\n\r\n        <!-- 登录提示 -->\r\n        <coreshop-login-modal></coreshop-login-modal>\r\n    </view>\r\n\r\n</template>\r\n<script>\r\n    import { goods } from '@/common/mixins/mixinsHelper.js';\r\n    export default {\r\n        mixins: [goods],\r\n        data() {\r\n            return {\r\n                background: {\r\n                    backgroundColor: '#e54d42',\r\n                },\r\n                actionStyle: {\r\n                    color: '#ffffff',\r\n                },\r\n                searchKey: '',\r\n                // 总价\r\n                totalprice: '0.00',\r\n                // 选择文本\r\n                selectText: '全选',\r\n                // 购物车数据 可以来自 api 请求或本地数据\r\n                shoppingCard: [],\r\n                cartData: {}, //购物车数据\r\n                cartIds: [], //选中ids\r\n                goSettlement: false, //去结算按钮\r\n                selectAll: true\r\n            }\r\n        },\r\n        //页面加载\r\n        onShow: function () {\r\n            let userToken = this.$db.get('userToken');\r\n            if (userToken) {\r\n                this.getCartData(); //获取购物车数据\r\n            }\r\n        },\r\n        onLoad: function () {\r\n            // 初始化时候计算总价，如果使用api 获取购物车项目在 api 请求完成后执行此函数\r\n            this.countTotoal();\r\n        },\r\n        computed: {\r\n            // 从vuex中获取店铺名称\r\n            shopName() {\r\n                return this.$store.state.config.shopName;\r\n            },\r\n            GoodsStocksWarn() {\r\n                return this.$store.state.config.goodsStocksWarn;\r\n            }\r\n        },\r\n        methods: {\r\n            //数组转字符串\r\n            arrayToStr: function (array) {\r\n                return array.toString();\r\n            },\r\n\r\n            //获取购物车数据\r\n            getCartData: function () {\r\n                let _this = this;\r\n                let cartIds = _this.arrayToStr(_this.cartIds);\r\n                let data = {\r\n                    ids: cartIds,\r\n                    display: 'all'\r\n                };\r\n                this.$u.api.cartList(data).then(res => {\r\n                    if (res.status) {\r\n                        _this.shoppingCard = res.data;\r\n                        _this.showHandle(_this.shoppingCard); //数量设置\r\n                        //console.log(_this.shoppingCard);\r\n                    }\r\n                });\r\n            },\r\n\r\n            //渲染前配置数据\r\n            showHandle: function (data, flag = true) {\r\n                let _this = this;\r\n                let goSettlement = false;\r\n                for (let i in data.list) {\r\n                    //不可能购买0件\r\n                    if (data.list[i].nums < 1) {\r\n                        data.list[i].nums = 1;\r\n                    }\r\n                    //不能买大于库存的数量(库存不足)\r\n                    let stockNo = false;\r\n                    let maxStock = data.list[i].products.stock;\r\n                    if (data.list[i].nums > data.list[i].products.stock) {\r\n                        stockNo = true;\r\n                        maxStock = data.list[i].nums;\r\n                    }\r\n                    data.list[i].maxStock = maxStock;\r\n                    data.list[i].stockNo = stockNo;\r\n\r\n                    //库存紧张\r\n                    let stockTension = false;\r\n                    if (_this.GoodsStocksWarn >= data.list[i].products.stock) {\r\n                        stockTension = true;\r\n                    }\r\n                    data.list[i].stockTension = stockTension;\r\n\r\n                    //设置样式\r\n                    data.list[i].minStatus = 'normal';\r\n                    data.list[i].maxStatus = 'normal';\r\n                    if (data.list[i].nums == 1) {\r\n                        data.list[i].minStatus = 'disabled';\r\n                    }\r\n                    if (data.list[i].nums == data.list[i].products.stock) {\r\n                        data.list[i].maxStatus = 'disabled';\r\n                    }\r\n\r\n                    //设置规格参数\r\n                    data.list[i].spes = [];\r\n                    if (data.list[i].products.spesDesc != null) {\r\n                        let spesArray = data.list[i].products.spesDesc.split(',');\r\n                        for (let key in spesArray) {\r\n                            let spesOne = spesArray[key].split(':');\r\n                            data.list[i].spes.push(spesOne[1]);\r\n                        }\r\n                    }\r\n                    //添加左滑效果\r\n                    data.list[i].isTouchMove = false;\r\n                    //是否可以去支付\r\n                    if (data.list[i].isSelect) {\r\n                        goSettlement = true;\r\n                    }\r\n                    //id转换为字符串\r\n                    data.list[i].id = _this.arrayToStr(data.list[i].id);\r\n                    //选中状态\r\n                    if (flag) {\r\n                        data.list[i].isSelect = true;\r\n                        if (data.list[i].isSelect) {\r\n                            if (_this.cartIds.indexOf(data.list[i].id) < 0) {\r\n                                _this.cartIds.push(data.list[i].id);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                data.goodsPromotionMoney = _this.$common.formatMoney(data.goodsPromotionMoney, 2, '');\r\n                data.orderPromotionMoney = _this.$common.formatMoney(data.orderPromotionMoney, 2, '');\r\n                data.amount = _this.$common.formatMoney(data.amount, 2, '');\r\n                let isLoad = false;\r\n                if (data.list.length < 1) {\r\n                    isLoad = true;\r\n                }\r\n                let n = 0;\r\n                for (let i in data.promotionList) {\r\n                    n++;\r\n                }\r\n\r\n                _this.goSettlement = goSettlement;\r\n                _this.isLoad = isLoad;\r\n                _this.cartNums = n;\r\n\r\n                if (flag) {\r\n                    _this.cartData = data;\r\n                } else {\r\n                    _this.getCartData();\r\n                }\r\n                _this.countTotoal();\r\n            },\r\n\r\n            //计算总计函数\r\n            countTotoal: function () {\r\n                let _that = this;\r\n                var total = 0;\r\n                for (let i in _that.shoppingCard.list) {\r\n                    if (_that.shoppingCard.list[i].isSelect) {\r\n                        total += Number(_that.shoppingCard.list[i].products.price) * Number(_that.shoppingCard.list[i].nums);\r\n                    }\r\n                }\r\n                _that.totalprice = _that.$common.formatMoney(total, 2, '');\r\n            },\r\n            numberChange: function (d) {\r\n                var id = this.shoppingCard.list[d.index].productId;\r\n                var nums = d.value;\r\n                let _this = this;\r\n                let data = {\r\n                    id: id,\r\n                    nums: nums\r\n                };\r\n                _this.$u.api.setCartNum(data).then(res => {\r\n                    if (res.status) {\r\n                        _this.shoppingCard.list[d.index].nums = d.value;\r\n                    } else {\r\n                        _this.$u.toast(res.msg);\r\n                    }\r\n                });\r\n                //重新计算总价\r\n                this.countTotoal();\r\n            },\r\n            removeGoods: function (index) {\r\n                console.log(index);\r\n                let _this = this;\r\n                var index = index;\r\n                uni.showModal({\r\n                    title: '确认提醒',\r\n                    content: '您确定要移除此商品吗？',\r\n                    success: (e) => {\r\n                        if (e.confirm) {\r\n                            //移除数据库\r\n                            let data = {\r\n                                id: _this.shoppingCard.list[index].id\r\n                            };\r\n                            _this.$u.api.removeCart(data).then(res => {\r\n                                if (res.status) {\r\n                                    //清除已经勾选的商品和购物车数据\r\n                                    var idIndex = _this.cartIds.indexOf(_this.shoppingCard.list[index].id);\r\n                                    if (idIndex > -1) {\r\n                                        _this.cartIds.splice(index, 1);\r\n                                    }\r\n                                    _this.shoppingCard.list.splice(index, 1);\r\n                                    //计算总价\r\n                                    _this.countTotoal();\r\n                                    _this.$refs.uToast.show({ title: res.msg, type: 'success', back: false });\r\n                                }\r\n                            });\r\n\r\n                        }\r\n                    }\r\n                })\r\n            },\r\n            checkout: function () {\r\n                let _this = this;\r\n                let cartData = _this.shoppingCard.list;\r\n                let newData = '';\r\n                for (let key in cartData) {\r\n                    if (cartData[key].isSelect == true) {\r\n                        newData += ',' + cartData[key].id;\r\n                        _this.goSettlement = true;\r\n                    }\r\n                }\r\n                if (newData.substr(0, 1) == ',') {\r\n                    newData = newData.substr(1);\r\n                }\r\n                if (newData.length > 0) {\r\n                    _this.$u.route('/pages/placeOrder/index/index?cartIds=' + JSON.stringify(newData));\r\n                    return true;\r\n                } else {\r\n                    //没有选择不跳转\r\n                }\r\n\r\n            },\r\n            // 商品选中\r\n            itemChange: function (e) {\r\n                var _this = this;\r\n                var index = Number(e.name);\r\n                var bl = e.value;\r\n                let cartData = _this.shoppingCard;\r\n                cartData.list[index].isSelect = bl;\r\n                if (bl) {\r\n                    if (_this.cartIds.indexOf(cartData.list[index].id) < 0) {\r\n                        _this.cartIds.push(cartData.list[index].id);\r\n                    }\r\n                } else {\r\n                    var idIndex = _this.cartIds.indexOf(cartData.list[index].id);\r\n                    if (idIndex > -1) {\r\n                        _this.cartIds.splice(index, 1);\r\n                    }\r\n                }\r\n                _this.shoppingCard = cartData;\r\n                this.countTotoal();\r\n                if (_this.cartIds.length == _this.shoppingCard.list.length) {\r\n                    this.selectAll = true;\r\n                    let e = { value: true };\r\n                    this.itemChangeAll(e);\r\n                } else {\r\n                    this.selectAll = false;\r\n                }\r\n\r\n            },\r\n            itemChangeAll: function (e) {\r\n                let _this = this;\r\n                var bl = e.value;\r\n                this.selectText = bl ? '全选' : '全不选';\r\n                var ids = [];\r\n                for (var i = 0; i < this.shoppingCard.list.length; i++) {\r\n                    this.shoppingCard.list[i].isSelect = bl;\r\n                    if (bl) {\r\n                        ids.push(this.shoppingCard.list[i].id);\r\n                    }\r\n                }\r\n                if (bl) {\r\n                    _this.cartIds = ids;\r\n                } else {\r\n                    _this.cartIds = [];\r\n                }\r\n\r\n                this.countTotoal();\r\n            },\r\n            goSearch() {\r\n                if (this.searchKey != '') {\r\n                    this.$u.route('/pages/category/list/list?key=' + this.searchKey);\r\n                } else {\r\n                    this.$refs.uToast.show({\r\n                        title: '请输入查询关键字',\r\n                        type: 'warning',\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n    @import \"cart.scss\";\r\n</style>","import mod from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=style&index=0&id=07f5d349&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=style&index=0&id=07f5d349&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1723964537981\n      var cssReload = require(\"E:/Share/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}